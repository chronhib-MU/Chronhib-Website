<div class="row mb-3 mt-3" #appTable>
  <div class="col">
    <div class="card shadow w-100">
      <div class="card-header border-0 pb-2" (click)="scrollToTable()">
        <div class="row">
          <div class="card-title text-uppercase mb-0 col">
            <h5 *ngIf="before && after !== before" class="mb-0 font-weight-bold text-muted">
              {{ before | titlecase }}
            </h5>
            <h2 class="mb-0 font-weight-bolder text-dark">
              {{ after | titlecase }}
              <span *ngIf="after === 'search'">
                {{ ' Results '
                }}<a class="text-primary pointer" placement="top" ngbTooltip="Click to copy Search URL" (click)="copyToClipboard()">
                  {{ '#' + tableData.currentApiQuery.id }}
                </a>
                {{ ' - ' + this.searchTable.data.length + ' matches' }}
              </span>
              <span *ngIf="after !== 'text' && tableData.currentApiQuery.fval">
                {{ ' - ' + tableData.currentApiQuery.fval }}
              </span>
            </h2>
          </div>

          <div class="btn-group col-auto pr-0">
            <label
              class="btn btn-secondary px-3 py-2"
              (click)="toggleMode('edit')"
              *ngIf="after !== 'search' || tableData.searchForm.get('tableColumns')['controls'].length === 1"
            >
              Edit <i class="fa fa-toggle-on" *ngIf="edit"></i><i class="fa fa-toggle-off" *ngIf="!edit"></i>
            </label>
            <label
              *ngIf="before && (after === 'sentences' || after === 'morphology')"
              class="btn btn-secondary px-3 py-2"
              (click)="toggleMode('ref')"
            >
              Ref. <i class="fa fa-toggle-on" *ngIf="ref"></i><i class="fa fa-toggle-off" *ngIf="!ref"></i>
            </label>
          </div>
          <div class="btn-group col-auto">
            <label class="btn btn-secondary px-3 py-2" (click)="toggleMode('sort')">
              Sort <i class="fa fa-toggle-on" *ngIf="sort"></i><i class="fa fa-toggle-off" *ngIf="!sort"></i>
            </label>
            <label class="btn btn-secondary px-3 py-2" (click)="toggleMode('wordWrap')">
              Word-Wrap <i class="fa fa-toggle-on" *ngIf="wordWrap"></i
              ><i class="fa fa-toggle-off" *ngIf="!wordWrap"></i>
            </label>
          </div>
          <div class="btn-group col-auto pl-0" *ngIf="edit">
            <label class="btn btn-secondary px-3 py-2" (click)="undo()"> Undo </label>
            <label class="btn btn-secondary px-3 py-2" (click)="redo()"> Redo </label>
          </div>
        </div>
      </div>
      <div class="mx-2 mb-2 row justify-content-between">
        <div class="text-left col-auto">
          <label class="btn btn-secondary px-3 py-2" (click)="goBack()"><i class="fas fa-arrow-left"></i></label>
          <label
            class="btn btn-secondary px-3 py-2"
            (click)="changeID('previous')"
            [hidden]="after === 'search' || after === 'text' || after === 'lemmata'"
          >
            <i class="fas fa-angle-double-left"></i>
          </label>
        </div>
        <div
          *ngIf="before && before !== after && after === 'morphology' && dataTable[before]?.data[0]"
          class="text-center col"
        >
          <h4>
            {{ dataTable[before].data[0].Textual_Unit }}
          </h4>
          <h4 class="text-muted">
            {{ dataTable[before].data[0].Translation }}
          </h4>
        </div>
        <div
          *ngIf="before && before !== after && after === 'sentences' && dataTable[before]?.data[0]"
          class="text-center col"
        >
          <h4 class="mt-2">
            {{ dataTable[before].data[0].Title.replaceAll('_', ' ') }}
          </h4>
          <h4 class="text-muted">
            {{ dataTable[before].data[0].Translation }}
          </h4>
        </div>
        <div class="text-right col-auto">
          <label
            class="btn btn-secondary px-3 py-2"
            (click)="changeID('next')"
            [hidden]="after === 'search' || after.toLowerCase() === 'text' || after.toLowerCase() === 'lemmata'"
          >
            <i class="fas fa-angle-double-right"></i>
          </label>
          <label class="btn btn-secondary px-3 py-2" (click)="goForward()"><i class="fas fa-arrow-right"></i></label>
        </div>
      </div>
      <ng-container *ngIf="this.after !== 'search'">
        <!-- Shows when we're not on the letter tables and not on the Lemmata Table -->
        <hot-table
          *ngIf="before && after !== 'text' && after !== 'lemmata' && ref"
          #hotMini
          [hotId]="instance + 'Mini'"
          [columns]="columnsMini"
          [rowHeaders]="null"
          [colHeaders]="true"
          [data]="getTableData(before)"
          [settings]="hotSettings[edit ? 1 : 0]"
          [height]="110"
          className="htCenter"
          licenseKey="non-commercial-and-evaluation"
          [id]="instance + 'Mini'"
        >
        </hot-table>
        <!-- Shows on all Tables and becomes a mini table as/on Lemmata -->
        <hot-table
          #hot
          [hotId]="instance"
          [columns]="columns"
          [rowHeaders]="getRows(after)"
          [colHeaders]="true"
          [data]="getTableData(after)"
          [settings]="hotSettings[edit ? 1 : 0]"
          [height]="before && after !== before && after === 'lemmata' ? 100 : '70vh'"
          className="htCenter"
          licenseKey="non-commercial-and-evaluation"
          [id]="instance"
        >
        </hot-table>
        <!-- Shows on the Lemmata Table as the big Morphology reference table-->
        <hot-table
          *ngIf="before && after !== before && after === 'lemmata'"
          #hotMini
          [hotId]="instance + 'Mini'"
          [columns]="columnsMini"
          [rowHeaders]="getRows(before)"
          [colHeaders]="true"
          [data]="getTableData(before)"
          [settings]="hotSettings[edit ? 1 : 0]"
          [height]="'70vh'"
          className="htCenter"
          licenseKey="non-commercial-and-evaluation"
          [id]="instance + 'Mini'"
        >
        </hot-table>
      </ng-container>
      <!-- Search Table-->
      <ng-container *ngIf="after === 'search'">
        <hot-table
          #hot
          [hotId]="instance"
          [columns]="columns"
          [rowHeaders]="getRows(after)"
          [colHeaders]="true"
          [data]="getTableData(after)"
          [settings]="hotSettings[edit ? 1 : 0]"
          [height]="'70vh'"
          className="htCenter"
          licenseKey="non-commercial-and-evaluation"
          [id]="instance"
        >
        </hot-table>
      </ng-container>
    </div>
  </div>
</div>
